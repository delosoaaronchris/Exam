@model RecyclingApp.Models.HomeViewModel

@{
    ViewBag.Title = "Home";
}

<h2>Create Recyclable Type</h2>
@using (Html.BeginForm("CreateRecyclableType", "Home", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{
    @Html.AntiForgeryToken()

    <div class="form-group">
        @Html.LabelFor(model => model.NewRecyclableType.Type, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.NewRecyclableType.Type, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.NewRecyclableType.Type, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.NewRecyclableType.Rate, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.NewRecyclableType.Rate, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.NewRecyclableType.Rate, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.NewRecyclableType.MinKg, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.NewRecyclableType.MinKg, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.NewRecyclableType.MinKg, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.NewRecyclableType.MaxKg, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.NewRecyclableType.MaxKg, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.NewRecyclableType.MaxKg, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" value="Create" class="btn btn-default" />
        </div>
    </div>
}

<h2>Create Recyclable Item</h2>
@using (Html.BeginForm("CreateRecyclableItem", "Home", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{
    @Html.AntiForgeryToken()

    <div class="form-group">
        @Html.LabelFor(model => model.NewRecyclableItem.RecyclableTypeId, "Recyclable Type", new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.DropDownListFor(model => model.NewRecyclableItem.RecyclableTypeId, new SelectList(Model.RecyclableTypes, "Id", "Type"), new { @class = "form-control" })
            @Html.ValidationMessageFor(model => model.NewRecyclableItem.RecyclableTypeId, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.NewRecyclableItem.Weight, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.NewRecyclableItem.Weight, new { htmlAttributes = new { @class = "form-control", onchange = "calculateRate()" } })
            @Html.ValidationMessageFor(model => model.NewRecyclableItem.Weight, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.NewRecyclableItem.ComputedRate, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            <span id="computedRate"></span>
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.NewRecyclableItem.ItemDescription, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.NewRecyclableItem.ItemDescription, new { htmlAttributes = new { @class = "form-control" } })
            @Html.ValidationMessageFor(model => model.NewRecyclableItem.ItemDescription, "", new { @class = "text-danger" })
        </div>
    </div>

    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" value="Create" class="btn btn-default" />
        </div>
    </div>

    <script>
        function calculateRate() {
            var weight = parseFloat($('#NewRecyclableItem_Weight').val());
            var rateText = $('#NewRecyclableItem_RecyclableTypeId option:selected').text();
            var rate = parseFloat(rateText.split(' - ')[1]);

            if (!isNaN(weight) && !isNaN(rate)) {
                var computedRate = weight * rate;
                $('#computedRate').text('Computed Rate: ' + computedRate.toFixed(2));
            } else {
                $('#computedRate').text('N/A');
            }
        }
    </script>
    // start of the list
    <h2>Recyclable Types</h2>
    <table class="table">
        <thead>
            <tr>
                <th>@Html.DisplayNameFor(model => model.RecyclableTypes.First().Type)</th>
                <th>@Html.DisplayNameFor(model => model.RecyclableTypes.First().Rate)</th>
                <th>@Html.DisplayNameFor(model => model.RecyclableTypes.First().MinKg)</th>
                <th>@Html.DisplayNameFor(model => model.RecyclableTypes.First().MaxKg)</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.RecyclableTypes)
            {
                <tr>
                    <td>@Html.DisplayFor(modelItem => item.Type)</td>
                    <td>@Html.DisplayFor(modelItem => item.Rate)</td>
                    <td>@Html.DisplayFor(modelItem => item.MinKg)</td>
                    <td>@Html.DisplayFor(modelItem => item.MaxKg)</td>
                </tr>
            }
        </tbody>
    </table>

    <h2>Recyclable Items</h2>
    <table class="table">
        <thead>
            <tr>
                <th>@Html.DisplayNameFor(model => model.RecyclableItems.First().RecyclableType.Type)</th>
                <th>@Html.DisplayNameFor(model => model.RecyclableItems.First().Weight)</th>
                <th>@Html.DisplayNameFor(model => model.RecyclableItems.First().ComputedRate)</th>
                <th>@Html.DisplayNameFor(model => model.RecyclableItems.First().ItemDescription)</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.RecyclableItems)
            {
                <tr>
                    <td>@Html.DisplayFor(modelItem => item.RecyclableType.Type)</td>
                    <td>@Html.DisplayFor(modelItem => item.Weight)</td>
                    <td>@Html.DisplayFor(modelItem => item.ComputedRate)</td>
                    <td>@Html.DisplayFor(modelItem => item.ItemDescription)</td>

                </tr>
            }
        </tbody>
    </table>

}
